<h1 style="text-align: center;">💧2024년 K-water 대국민 물 빅데이터 공모전</h1>
<hr>
<p style="text-align: center;">
    <a href="https://github.com/donghyun0518/K-water-bigdata/blob/main/%EB%B0%9C%ED%91%9C%20%ED%94%BC%ED%94%BC%ED%8B%B0%20v1.0_%EC%B5%9C%EC%A2%85%EB%B3%B8.pdf" target="_blank">
        <img src="https://github.com/donghyun0518/K-water-bigdata/blob/main/%EC%88%98%EC%9E%90%EC%9B%90%ED%91%9C%EC%A7%80.png" alt="Project Cover" style="width: 1000px; border: 1px solid #c9d1d9; border-radius: 8px;">
    </a>
</p>

[프로젝트 발표 자료](https://github.com/donghyun0518/K-water-bigdata/blob/main/%EB%B0%9C%ED%91%9C%20%ED%94%BC%ED%94%BC%ED%8B%B0%20v1.0_%EC%B5%9C%EC%A2%85%EB%B3%B8.pdf)

## 🔍 프로젝트 개요
- **목적** : 효율적인 물 자원 관리, 정확한 예측과 계획 수립, 가뭄 대응력 강화를 위한 가뭄 경보 시스템 개발
- **주제** : SPI6를 활용한 미래 가뭄 예측 시스템: 기상 및 수문 데이터 통합, 머신러닝 기반 가뭄 예측 모델 개발
- **기간** : 2024.05.22 ~ 2024.07.18 (약 4주간)
- **팀 구성** : 5인
- **성과** : 장려상 수상

## ⚙️ 주요 수행 과정
**1. **문제 정의****
   - 급격한 기후 변화와 도시화 등 여러 요인으로 인해 세계 인구의 40% 가량은 만성적인 물 부족 상황이 발생하고 있다.
   - 현재 한국의 경우 사용 가능한 수자원 대비 물 수요 비율이 높은 국가인 물 스트레스 국가이다.
   - 한국은 계절별 강수량의 편차가 매우 크며, 국토 면적이 좁고 인구밀도가 높아 물 부족 현상이 심각해질 우려가 있다.
   - 이를 선제 대응하기 위해 일별 강수량, 계절 그리고 댐의 저수량 데이터를 활용한 가뭄 예측이 필요하다.

**2. **데이터 수집 및 전처리****
   - 데이터 출처 : 기상청-기상자료개방포털, My Water
   - 데이터 수집
     - 종관기상관측(ASOS)(2019년 ~ 2022년)
     - 표준강수지수 자료(2019년 ~ 2022년)
       - 대한민국 모든 종관기상 관측 지점에서 측정한 일별 SPI6 데이터 추출.
       - 대한민국 모든 종관기상관측 지점에 대한 일별 기온, 강수, 습도, 일조, 일사, 기압에 대한 데이터를 추출.
     - 기간별 자료(2018년 ~ 2022년) - 댐/보 기간별 자료
       - 다목적 댐과 용수 댐의 일별 강우량, 방류량, 저수량, 총 저수량, 유역, 유효 저수량 및 댐의 제원에 대한 데이터 추출.
   - **SQL(Oracle)과 R을 활용**
     - 기후 상황과 가뭄에 대한 효율적인 뮬자원 분배를 위해 대한민국의 강수 특성을 반영한 주요 댐 부근 지역 SPI6 예측 모델을 개발하고 사용자 편의를 고려한 R shiny 활용 UI를 구현하여 홈페이지를 제공한다.<br>
   - **전처리 작업**
     - **주요 다목적 댐 및 용수 댐(수문학적 요소)**
       - My Water 물 정보 포털에서 제공하는 주요 다목적 댐 및 용수 댐의 제원과 일별 강우량, 방류량, 저수량 데이터셋을 이용한다.
       - SQL을 활용하여 연도별로 구분 되어 있는 데이터셋을 통합한다.
     - **일별 기상 및 표준강수지수(SPI6) 데이터(기상학적 요소)**
       - 기상자료개방포털에서 제공하는 종관기상관측지점에서 측정한 기상 데이터와 이를 활용하여 기상청에서 제공하는 일별 표준강수지수(SPI6) 데이터를 이용한다.
       - SPI 지수를 예측을 위한 데이터로 예상된 일별 기온, 강수, 습도, 일조, 일사, 기압, SPI6 데이터를 SQL을 활용하여 분석하기 용이한 형태로 가공한다.
       - 표준강수지수(SPI6)를 계산하는데 있어서 직접적인 요소라고 할 수 있는 누적강수량에 대한 데이터를 구하기 어려워 기존 일별 강수량 데이터를 따로 분리하여 6개월 단위로 누적강수량을 계산하도록 코드를 작성한다.
       - 이를 토대로 표준강수지수(SPI) 예측 모델이 학습할 기상학적 요소가 담긴 훈련데이터를 생성한다.
     - **SQL 활용 방안**
       - 앞서 가공한 기상학적 요소와 수문학적 요소와의 결합을 위한 관측소 지점명을 지역명으로 통일한다.
       - 학습 데이터로써 활용하기 위해 기상학적 요소와 수문학적 요소가 담긴 데이터를 통합한다.

**3. **데이터 분석****
   - **1차 분석**
     - 데이터셋 구성 : 기상 데이터와 주요 댐 데이터를 통합한다.
     - 표준강수지수(SPI6) 예측을 위한 **변수 특정**을 위해 가뭄에 영향을 미치는 주요 요소들인 기상학적 요소와 수문학적 요소의 모든 변수들을 적용한다.
     - 모델의 **회귀분석 결과로 P-value와 상관관계를 확인**하여 불용 변수를 제거한다.
   - **2차 분석**
     - 1차의 결과로 특정된 변수들을 다시 모델에 적용시켜 **P-value와 상관관계를 확인**한다.
     - 예측에 필요한 최소한의 변수들을 특정한다.
   - **3차 분석**
     - **랜덤포레스트 모델**의 적용을 위해 SPI6의 수치를 기상청에서 지정한 수치 **범위별 등급**으로 분류한다.
     - 해당 변수들을 **R 프로그램을 활용한 분류 모델에 적용**한다.

**4. **모델 훈련****
   - 모델 설정 : 초기 데이터의 상관관계 분석을 위해 SQL 회귀분석 모델을 사용한다. SQL에서는 훈련데이터의 타겟 비율을 동일하게 적용할 수 없어 R을 통한 학습을 진행한다.
   - 랜덤포레스트 모델
     - 가공된 데이터셋을 적용
       - 학습데이터(n=42,392), 검증데이터(n=4,706)
     - 예측 모델의 정확도 향상을 위하여 추가 변수를 특정한다.
     - 의사결정나무의 수 변화(n=1~100)에 따른 모델의 정확도를 확인.
    
**5. 모델 성능 평가**
   - sensitivity, precision, specificity와 F1 score를 확인한다.
   - 각 분류 예측 결과에 대한 ROC 곡선 및 AUC를 계산한다.
   - 결정 트리의 갯수에 따른 F1 score와 정확도를 확인한다.
   - **최종 결과**
     - F1 score : 0.933
     - 정확도 : 96.1%
     - AUC : 0.955

**6. **R shiny를 통한 UI 홈페이지 제작****
   - [R shiny UI 홈페이지 접속 링크](https://spi-predictor.shinyapps.io/spi100/)

**7. 기대효과**
   - 효율적인 물 자원 관리
   - 조기 경보 시스템 구축
   - 기후 변화 대응

## 🧑🏻‍💻환경
- SQL(Oracle)
- R
- R shiny

